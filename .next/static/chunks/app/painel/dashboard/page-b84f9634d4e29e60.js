(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[223],{98079:function(e,t,s){Promise.resolve().then(s.bind(s,5504))},5504:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return R}});var a=s(3827),l=s(64090),r=s(27815),n=s(85754),d=s(31478),i=s(84950),o=s(66363),c=s(23356),x=s(22983),m=s(85758),u=s(2838);function b(e){let{data:t}=e,s=t.map(e=>({mes:new Date(e.mes).toLocaleDateString("pt-BR",{month:"short",year:"numeric"}),total:Number(e.total)}));return(0,a.jsx)("div",{className:"w-full h-64",children:(0,a.jsx)(i.h,{width:"100%",height:"100%",children:(0,a.jsxs)(o.w,{data:s,children:[(0,a.jsx)(c.K,{dataKey:"mes",stroke:"#94a3b8"}),(0,a.jsx)(x.B,{stroke:"#94a3b8"}),(0,a.jsx)(m.u,{contentStyle:{background:"#0f172a",border:"1px solid #334155"},labelStyle:{color:"#f1f5f9"},itemStyle:{color:"#facc15"}}),(0,a.jsx)(u.x1,{type:"monotone",dataKey:"total",stroke:"#facc15",strokeWidth:3})]})})})}var h=s(81433),g=s(86526);function j(e){let{data:t}=e,s=t.map(e=>({mes:new Date(e.mes).toLocaleDateString("pt-BR",{month:"short"}),total:Number(e.total)}));return(0,a.jsx)("div",{className:"w-full h-64",children:(0,a.jsx)(i.h,{width:"100%",height:"100%",children:(0,a.jsxs)(h.v,{data:s,children:[(0,a.jsx)(c.K,{dataKey:"mes",stroke:"#94a3b8"}),(0,a.jsx)(x.B,{stroke:"#94a3b8"}),(0,a.jsx)(m.u,{contentStyle:{background:"#0f172a",border:"1px solid #334155"},labelStyle:{color:"#f1f5f9"}}),(0,a.jsx)(g.$Q,{dataKey:"total",fill:"#38bdf8"})]})})})}function f(e){let{data:t}=e,s=t.map(e=>({serie:e.serie,total:e._count.serie}));return(0,a.jsx)("div",{className:"w-full h-64",children:(0,a.jsx)(i.h,{width:"100%",height:"100%",children:(0,a.jsxs)(h.v,{data:s,children:[(0,a.jsx)(c.K,{dataKey:"serie",stroke:"#94a3b8"}),(0,a.jsx)(x.B,{stroke:"#94a3b8"}),(0,a.jsx)(m.u,{contentStyle:{background:"#0f172a",border:"1px solid #334155"},labelStyle:{color:"#f1f5f9"}}),(0,a.jsx)(g.$Q,{dataKey:"total",fill:"#a78bfa"})]})})})}var p=s(23168),v=s(48713),N=s(74994);let w=["#22c55e","#facc15","#ef4444"];function y(e){let{data:t}=e,s=[{name:"Pago",value:t.pago},{name:"Pendente",value:t.pendente},{name:"Atrasado",value:t.atrasado}];return(0,a.jsx)("div",{className:"w-full h-64",children:(0,a.jsx)(i.h,{width:"100%",height:"100%",children:(0,a.jsxs)(p.u,{children:[(0,a.jsx)(v.b,{data:s,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:2,dataKey:"value",children:s.map((e,t)=>(0,a.jsx)(N.b,{fill:w[t]},t))}),(0,a.jsx)(m.u,{contentStyle:{background:"#0f172a",border:"1px solid #334155",color:"#fff"}})]})})})}function S(){return(0,a.jsxs)("div",{className:"space-y-8 animate-pulse",children:[(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-4",children:[1,2,3,4].map(e=>(0,a.jsxs)(r.Zb,{className:"p-4 bg-slate-900 border border-slate-700 h-28",children:[(0,a.jsx)("div",{className:"h-3 w-20 bg-slate-700/60 rounded mb-3"}),(0,a.jsx)("div",{className:"h-6 w-24 bg-slate-700/70 rounded"})]},e))}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-3",children:[1,2,3].map(e=>(0,a.jsxs)(r.Zb,{className:"p-4 bg-slate-900 border border-slate-700 h-24",children:[(0,a.jsx)("div",{className:"h-3 w-20 bg-slate-700/60 rounded mb-2"}),(0,a.jsx)("div",{className:"h-5 w-20 bg-slate-700/70 rounded"})]},e))}),(0,a.jsx)("div",{className:"grid gap-6 lg:grid-cols-2",children:[1,2].map(e=>(0,a.jsxs)(r.Zb,{className:"p-4 bg-slate-900 border border-slate-700 h-64",children:[(0,a.jsx)("div",{className:"h-4 w-32 bg-slate-700/60 rounded mb-4"}),(0,a.jsx)("div",{className:"h-full bg-slate-800/40 rounded"})]},e))})]})}var k=s(18025),A=s(34059),Z=s(69475),P=s(10527),C=s(8792);function D(e){let{value:t,duration:s=800}=e,[r,n]=(0,l.useState)(0);return(0,l.useEffect)(()=>{let e=0,a=Number(t);if(e===a)return;let l=setInterval(()=>{n(e+=1),e>=a&&clearInterval(l)},Math.max(Math.abs(Math.floor(s/(a-e))),20));return()=>clearInterval(l)},[t,s]),(0,a.jsx)("span",{children:r.toLocaleString("pt-BR")})}function R(){var e,t,s;let[i,o]=(0,l.useState)([]),[c,x]=(0,l.useState)([]),[m,u]=(0,l.useState)([]),[h,g]=(0,l.useState)([]),[p,v]=(0,l.useState)([]),[N,w]=(0,l.useState)([]),[D,R]=(0,l.useState)([]),[E,K]=(0,l.useState)(null),[T,L]=(0,l.useState)(!0);async function _(){L(!0);let[e,t,s,a,l,r,n,d]=await Promise.all([fetch("/api/alunos"),fetch("/api/responsaveis"),fetch("/api/pre-matriculas"),fetch("/api/pagamentos"),fetch("/api/dashboard-pagamentos-mes"),fetch("/api/dashboard-prematriculas-mes"),fetch("/api/dashboard-alunos-serie"),fetch("/api/dashboard-financeiro-geral")]);o(await e.json()),x(await t.json()),u(await s.json()),g(await a.json()),v(await l.json()),w(await r.json()),R(await n.json()),K(await d.json()),L(!1)}function M(e){return null==e?void 0:e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}function O(e){return e?new Date(e).toLocaleDateString("pt-BR"):"—"}(0,l.useEffect)(()=>{_()},[]);let z=(0,l.useMemo)(()=>{let e=0,t=0,s=0,a=0;h.forEach(l=>{var r;let n=null!==(r=l.valor)&&void 0!==r?r:0;e+=n;let d=(l.status||"").toUpperCase();"PAGO"===d?t+=n:"ATRASADO"===d?a+=n:s+=n});let l=m.filter(e=>["novo","pendente","analise"].some(t=>e.status.toLowerCase().includes(t))).length;return{total:e,pago:t,pendente:s,atrasado:a,prePendentes:l}},[h,m]),I=(0,l.useMemo)(()=>[...h].sort((e,t)=>new Date(t.vencimento).getTime()-new Date(e.vencimento).getTime()).slice(0,5),[h]),V=(0,l.useMemo)(()=>[...m].sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()).slice(0,5),[m]);return(0,a.jsxs)("div",{className:"space-y-10",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-100",children:"Vis\xe3o geral do gestor"}),(0,a.jsx)("p",{className:"text-sm text-slate-400",children:"Acompanhe rapidamente os indicadores da escola."})]}),(0,a.jsxs)(n.z,{variant:"primary",onClick:_,disabled:T,className:"flex items-center gap-2",children:["Atualizar dados",(0,a.jsx)(k.Z,{className:"h-4 w-4"})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsx)(B,{icon:(0,a.jsx)(A.Z,{className:"h-5 w-5 text-yellow-400"}),title:"Alunos ativos",value:(null!==(e=null==i?void 0:i.length)&&void 0!==e?e:0).toString(),subtitle:"Total de alunos cadastrados"}),(0,a.jsx)(B,{icon:(0,a.jsx)(A.Z,{className:"h-5 w-5 text-slate-300"}),title:"Respons\xe1veis",value:(null!==(t=null==c?void 0:c.length)&&void 0!==t?t:0).toString(),subtitle:"Pagadores vinculados"}),(0,a.jsx)(B,{icon:(0,a.jsx)(Z.Z,{className:"h-5 w-5 text-amber-300"}),title:"Pr\xe9-matr\xedculas pendentes",value:(null!==(s=null==z?void 0:z.prePendentes)&&void 0!==s?s:0).toString(),subtitle:"Aguardando an\xe1lise"}),(0,a.jsx)(B,{icon:(0,a.jsx)(P.Z,{className:"h-5 w-5 text-green-400"}),title:"Total em cobran\xe7as",value:M(z.total),subtitle:"Bruto lan\xe7ado no sistema"})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsx)(B,{title:"Recebido",value:M(z.pago),subtitle:"Pagamentos pagos"}),(0,a.jsx)(B,{title:"Pendente",value:M(z.pendente),subtitle:"Cobran\xe7as em aberto"}),(0,a.jsx)(B,{title:"Em atraso",value:M(z.atrasado),subtitle:"Cobran\xe7as vencidas"})]}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,a.jsxs)(r.Zb,{className:"p-4 bg-slate-900 border border-slate-700",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-slate-100 mb-3",children:"Pagamentos por m\xeas"}),0===p.length?(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Nenhum dado dispon\xedvel."}):(0,a.jsx)(b,{data:p})]}),(0,a.jsxs)(r.Zb,{className:"p-4 bg-slate-900 border border-slate-700",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-slate-100 mb-3",children:"Pr\xe9-matr\xedculas por m\xeas"}),0===N.length?(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Nenhum dado dispon\xedvel."}):(0,a.jsx)(j,{data:N})]})]}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,a.jsxs)(r.Zb,{className:"p-4 bg-slate-900 border border-slate-700",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-slate-100 mb-3",children:"Alunos por s\xe9rie"}),0===D.length?(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Nenhum dado dispon\xedvel."}):(0,a.jsx)(f,{data:D})]}),(0,a.jsxs)(r.Zb,{className:"p-4 bg-slate-900 border border-slate-700",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-slate-100 mb-3",children:"Situa\xe7\xe3o financeira geral"}),E?(0,a.jsx)(y,{data:E}):(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Nenhum dado dispon\xedvel."})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,a.jsxs)(r.Zb,{className:"p-4 bg-slate-900 border border-slate-700",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-slate-100",children:"\xdaltimos pagamentos"}),(0,a.jsx)(C.default,{href:"/painel/financeiro",children:(0,a.jsxs)("button",{className:"text-xs text-yellow-400 hover:underline flex items-center gap-1",children:["Ver financeiro",(0,a.jsx)(k.Z,{className:"h-3 w-3"})]})})]}),T?(0,a.jsx)(S,{}):(0,a.jsx)("div",{className:"space-y-2",children:I.map(e=>{var t,s;return(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-slate-800 bg-slate-900/60 px-3 py-2",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-sm text-slate-100",children:e.descricao}),(0,a.jsxs)("span",{className:"text-xs text-slate-400",children:[null!==(s=null===(t=e.aluno)||void 0===t?void 0:t.nome)&&void 0!==s?s:"Sem aluno"," •"," ",O(e.vencimento)]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm font-semibold text-slate-100",children:M(e.valor)}),(0,a.jsx)("div",{className:"text-xs",children:function(e){let t=e.toUpperCase();return"PAGO"===t?(0,a.jsx)(d.C,{variant:"success",children:"Pago"}):"ATRASADO"===t?(0,a.jsx)(d.C,{variant:"danger",children:"Atrasado"}):"PENDENTE"===t?(0,a.jsx)(d.C,{variant:"warning",children:"Pendente"}):(0,a.jsx)(d.C,{variant:"outline",children:e})}(e.status)})]})]},e.id)})})]}),(0,a.jsxs)(r.Zb,{className:"p-4 bg-slate-900 border border-slate-700",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-slate-100",children:"\xdaltimas pr\xe9-matr\xedculas"}),(0,a.jsx)(C.default,{href:"/painel/pre-matriculas",children:(0,a.jsxs)("button",{className:"text-xs text-yellow-400 hover:underline flex items-center gap-1",children:["Ver todas",(0,a.jsx)(k.Z,{className:"h-3 w-3"})]})})]}),T?(0,a.jsx)("p",{className:"text-sm text-slate-400",children:"Carregando..."}):0===V.length?(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Nenhuma pr\xe9-matr\xedcula recente."}):(0,a.jsx)("div",{className:"space-y-2",children:V.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-slate-800 bg-slate-900/60 px-3 py-2",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-sm text-slate-100",children:e.alunoNome}),(0,a.jsxs)("span",{className:"text-xs text-slate-400",children:["Resp.: ",e.respNome]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-xs text-slate-400",children:O(e.createdAt)}),(0,a.jsx)("div",{className:"text-xs mt-1",children:(0,a.jsx)(d.C,{variant:"outline",children:e.status})})]})]},e.id))})]})]})]})}function B(e){let{title:t,value:s,subtitle:l,icon:n}=e;return(0,a.jsxs)(r.Zb,{className:"p-4 bg-slate-900 border border-slate-700 flex flex-col justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:t}),(0,a.jsx)("p",{className:"mt-2 text-xl font-bold text-slate-100",children:(0,a.jsx)(D,{value:Number(String(s).replace(/\D/g,""))})})]}),n&&(0,a.jsx)("div",{className:"rounded-lg bg-slate-800/80 p-2 shadow-sm",children:n})]}),l&&(0,a.jsx)("p",{className:"mt-2 text-xs text-slate-500",children:l})]})}},31478:function(e,t,s){"use strict";s.d(t,{C:function(){return r}});var a=s(3827);s(64090);var l=s(1657);function r(e){let{className:t,variant:s="default",...r}=e;return(0,a.jsx)("span",{className:(0,l.cn)("inline-flex items-center rounded-full px-2.5 py-0.5","text-[11px] font-medium uppercase tracking-wide",{default:"bg-slate-800 text-slate-100 border border-slate-700",outline:"bg-transparent text-slate-200 border border-slate-500",success:"bg-emerald-600/20 text-emerald-300 border border-emerald-500/50",warning:"bg-amber-500/15 text-amber-300 border border-amber-400/70",danger:"bg-red-500/15 text-red-300 border border-red-400/70"}[s],t),role:"status",...r})}},85754:function(e,t,s){"use strict";s.d(t,{z:function(){return r}});var a=s(3827);s(64090);var l=s(1657);function r(e){let{className:t,variant:s="primary",size:r="default",...n}=e;return(0,a.jsx)("button",{className:(0,l.cn)("inline-flex items-center justify-center gap-2 rounded-lg font-medium transition-all select-none","focus:outline-none focus:ring-2 focus:ring-yellow-500/70 focus:ring-offset-2 focus:ring-offset-slate-950","disabled:cursor-not-allowed disabled:opacity-70",{primary:"bg-yellow-500 text-slate-900 hover:bg-yellow-400 disabled:bg-yellow-700/60 disabled:text-slate-400",secondary:"bg-slate-700 text-slate-100 hover:bg-slate-600 disabled:bg-slate-800/70 disabled:text-slate-400",ghost:"bg-transparent text-slate-200 hover:bg-slate-800/40 disabled:text-slate-500 disabled:hover:bg-transparent",danger:"bg-red-500 text-white hover:bg-red-400 disabled:bg-red-700/70 disabled:text-red-300",destructive:"bg-red-700 text-white hover:bg-red-600 disabled:bg-red-900/60 disabled:text-red-300",success:"bg-green-600 text-white hover:bg-green-500 disabled:bg-green-800/60 disabled:text-green-200",warning:"bg-orange-500 text-white hover:bg-orange-400 disabled:bg-orange-700/60 disabled:text-orange-200",outline:"border border-slate-600 text-slate-200 hover:bg-slate-800/30 disabled:opacity-50 disabled:hover:bg-transparent",link:"underline underline-offset-2 text-yellow-400 hover:text-yellow-300 p-0 bg-transparent disabled:text-yellow-600",soft:"bg-yellow-500/15 text-yellow-400 hover:bg-yellow-500/25 disabled:opacity-50 disabled:text-yellow-600"}[s],{sm:"h-8 px-3 text-xs",default:"h-10 px-4 text-sm",lg:"h-12 px-6 text-base"}[r],t),...n})}},27815:function(e,t,s){"use strict";s.d(t,{Zb:function(){return r}});var a=s(3827);s(64090);var l=s(1657);function r(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,l.cn)("rounded-2xl border border-slate-800 bg-slate-900/80 backdrop-blur-sm","p-4 shadow-md shadow-black/40 transition","hover:shadow-lg hover:shadow-black/50",t),...s})}},1657:function(e,t,s){"use strict";s.d(t,{cn:function(){return r}});var a=s(75504),l=s(51367);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,l.m6)((0,a.W)(t))}}},function(e){e.O(0,[150,434,843,971,69,744],function(){return e(e.s=98079)}),_N_E=e.O()}]);