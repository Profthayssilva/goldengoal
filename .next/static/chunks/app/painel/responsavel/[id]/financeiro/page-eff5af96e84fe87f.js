(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[340],{68573:function(e,t,a){Promise.resolve().then(a.bind(a,13881))},13881:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var r=a(3827),s=a(64090),l=a(47907),n=a(8792),o=a(27815),i=a(85754),d=a(31478),c=a(45179),u=a(57977);let x=(0,u.Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),m=(0,u.Z)("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var b=a(10527);function h(){let e=(0,l.useParams)().id,[t,a]=(0,s.useState)(null),[c,u]=(0,s.useState)([]),[b,h]=(0,s.useState)(!0),[v,j]=(0,s.useState)(!1),[y,w]=(0,s.useState)(null);async function N(){h(!0);let[t,r]=await Promise.all([fetch("/api/responsaveis/".concat(e)),fetch("/api/pagamentos?responsavelId=".concat(e))]);a(await t.json()),u(await r.json()),h(!1)}(0,s.useEffect)(()=>{e&&N()},[e]);let k=(0,s.useMemo)(()=>{let e=0,t=0,a=0,r=0;return c.forEach(s=>{var l;let n=null!==(l=s.valor)&&void 0!==l?l:0;e+=n;let o=(s.status||"").toUpperCase();"PAGO"===o?t+=n:"ATRASADO"===o?r+=n:a+=n}),{total:e,pago:t,pendente:a,atrasado:r}},[c]);async function C(e){await fetch("/api/pagamentos/".concat(e),{method:"PUT",body:JSON.stringify({status:"PAGO"})}),await N()}return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(n.default,{href:"/painel/responsavel",children:(0,r.jsxs)(i.z,{variant:"secondary",size:"sm",children:[(0,r.jsx)(x,{className:"h-4 w-4 mr-1"}),"Voltar"]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-lg md:text-xl font-bold text-slate-100",children:"Financeiro do Respons\xe1vel"}),t&&(0,r.jsxs)("p",{className:"text-xs md:text-sm text-slate-400",children:[t.nome," • ",t.email,t.telefone&&" • ".concat(t.telefone)]})]})]}),(0,r.jsxs)(i.z,{variant:"primary",onClick:()=>j(!0),className:"flex items-center gap-2",children:[(0,r.jsx)(m,{className:"h-4 w-4"}),"Nova cobran\xe7a"]})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,r.jsx)(p,{titulo:"Total lan\xe7ado",valor:k.total}),(0,r.jsx)(p,{titulo:"Pago",valor:k.pago}),(0,r.jsx)(p,{titulo:"Pendente",valor:k.pendente}),(0,r.jsx)(p,{titulo:"Em atraso",valor:k.atrasado})]}),(0,r.jsx)(o.Zb,{className:"p-4 bg-slate-900 border border-slate-700",children:b?(0,r.jsx)("p",{className:"text-sm text-slate-400",children:"Carregando..."}):0===c.length?(0,r.jsx)("p",{className:"text-sm text-slate-400",children:"Nenhuma cobran\xe7a cadastrada para este respons\xe1vel."}):(0,r.jsx)("div",{className:"space-y-3",children:c.map(e=>{var t,a;return(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 p-3 rounded-lg bg-slate-800/60 border border-slate-700",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-slate-100 font-medium",children:e.descricao}),(0,r.jsxs)("p",{className:"text-xs text-slate-400",children:[null!==(a=null===(t=e.aluno)||void 0===t?void 0:t.nome)&&void 0!==a?a:"Sem aluno"," • Vencimento:"," ",new Date(e.vencimento).toLocaleDateString("pt-BR")]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 md:text-right",children:[(0,r.jsxs)("div",{className:"text-sm font-semibold text-slate-100",children:[e.valor.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),(0,r.jsx)("div",{className:"mt-1",children:function(e){let t=e.toUpperCase();return"PAGO"===t?(0,r.jsx)(d.C,{variant:"success",children:"Pago"}):"ATRASADO"===t?(0,r.jsx)(d.C,{variant:"danger",children:"Atrasado"}):"PENDENTE"===t?(0,r.jsx)(d.C,{variant:"warning",children:"Pendente"}):(0,r.jsx)(d.C,{variant:"outline",children:e})}(e.status)})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.z,{size:"sm",variant:"secondary",onClick:()=>w(e),children:"Ver"}),"PAGO"!==e.status.toUpperCase()&&(0,r.jsx)(i.z,{size:"sm",variant:"primary",onClick:()=>C(e.id),children:"Marcar pago"})]})]})]},e.id)})})}),v&&t&&(0,r.jsx)(f,{responsavel:t,onClose:()=>j(!1),onSaved:N}),y&&(0,r.jsx)(g,{pagamento:y,onClose:()=>w(null)})]})}function p(e){let{titulo:t,valor:a}=e;return(0,r.jsx)(o.Zb,{className:"p-4 bg-slate-900 border border-slate-700 flex flex-col justify-between",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-slate-400 uppercase tracking-wide",children:t}),(0,r.jsx)("p",{className:"mt-2 text-lg font-bold text-slate-100",children:a.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]}),(0,r.jsx)(b.Z,{className:"h-5 w-5 text-yellow-400"})]})})}function f(e){let{responsavel:t,onClose:a,onSaved:l}=e,[n,d]=(0,s.useState)(""),[u,x]=(0,s.useState)(""),[m,b]=(0,s.useState)(""),[h,p]=(0,s.useState)(""),[f,g]=(0,s.useState)(!1);async function v(){n&&u&&m&&h&&(g(!0),await fetch("/api/pagamentos/create",{method:"POST",body:JSON.stringify({descricao:n,valor:Number(u),vencimento:m,alunoId:h,responsavelId:t.id,tipo:"PIX"})}),g(!1),l(),a())}return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,r.jsxs)(o.Zb,{className:"w-full max-w-md p-6 bg-slate-900 border border-slate-700 space-y-4",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-slate-100",children:["Nova cobran\xe7a para ",t.nome]}),(0,r.jsx)(c.I,{placeholder:"Descri\xe7\xe3o",value:n,onChange:e=>d(e.target.value)}),(0,r.jsx)(c.I,{placeholder:"Valor (R$)",type:"number",value:u,onChange:e=>x(e.target.value)}),(0,r.jsx)(c.I,{type:"date",value:m,onChange:e=>b(e.target.value)}),(0,r.jsxs)("select",{className:"w-full rounded-md border border-slate-700 bg-slate-800 p-2 text-sm text-slate-100",value:h,onChange:e=>p(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Selecione o aluno"}),t.alunos.map(e=>(0,r.jsx)("option",{value:e.id,children:e.nome},e.id))]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,r.jsx)(i.z,{variant:"secondary",onClick:a,children:"Cancelar"}),(0,r.jsx)(i.z,{variant:"primary",disabled:f,onClick:v,children:f?"Gerando...":"Criar cobran\xe7a"})]})]})})}function g(e){let{pagamento:t,onClose:a}=e;return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,r.jsxs)(o.Zb,{className:"w-full max-w-md p-6 bg-slate-900 border border-slate-700 space-y-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-slate-100",children:"Detalhes da cobran\xe7a"}),(0,r.jsxs)("p",{className:"text-sm text-slate-300",children:[(0,r.jsx)("strong",{children:"Descri\xe7\xe3o:"})," ",t.descricao]}),(0,r.jsxs)("p",{className:"text-sm text-slate-300",children:[(0,r.jsx)("strong",{children:"Valor:"})," ",t.valor.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]}),(0,r.jsxs)("p",{className:"text-sm text-slate-300",children:[(0,r.jsx)("strong",{children:"Status:"})," ",t.status]}),t.boletoUrl&&(0,r.jsx)("a",{href:t.boletoUrl,target:"_blank",rel:"noreferrer",className:"text-xs text-yellow-400 underline",children:"Abrir boleto"}),t.pixQrCode&&(0,r.jsx)("img",{src:t.pixQrCode,alt:"QR Code PIX",className:"w-40 mx-auto"}),t.pixPayload&&(0,r.jsx)(i.z,{variant:"primary",onClick:()=>navigator.clipboard.writeText(t.pixPayload),children:"Copiar c\xf3digo PIX"}),(0,r.jsx)("div",{className:"flex justify-end pt-2",children:(0,r.jsx)(i.z,{variant:"secondary",onClick:a,children:"Fechar"})})]})})}},31478:function(e,t,a){"use strict";a.d(t,{C:function(){return l}});var r=a(3827);a(64090);var s=a(1657);function l(e){let{className:t,variant:a="default",...l}=e;return(0,r.jsx)("span",{className:(0,s.cn)("inline-flex items-center rounded-full px-2.5 py-0.5","text-[11px] font-medium uppercase tracking-wide",{default:"bg-slate-800 text-slate-100 border border-slate-700",outline:"bg-transparent text-slate-200 border border-slate-500",success:"bg-emerald-600/20 text-emerald-300 border border-emerald-500/50",warning:"bg-amber-500/15 text-amber-300 border border-amber-400/70",danger:"bg-red-500/15 text-red-300 border border-red-400/70"}[a],t),role:"status",...l})}},85754:function(e,t,a){"use strict";a.d(t,{z:function(){return l}});var r=a(3827);a(64090);var s=a(1657);function l(e){let{className:t,variant:a="primary",size:l="default",...n}=e;return(0,r.jsx)("button",{className:(0,s.cn)("inline-flex items-center justify-center gap-2 rounded-lg font-medium transition-all select-none","focus:outline-none focus:ring-2 focus:ring-yellow-500/70 focus:ring-offset-2 focus:ring-offset-slate-950","disabled:cursor-not-allowed disabled:opacity-70",{primary:"bg-yellow-500 text-slate-900 hover:bg-yellow-400 disabled:bg-yellow-700/60 disabled:text-slate-400",secondary:"bg-slate-700 text-slate-100 hover:bg-slate-600 disabled:bg-slate-800/70 disabled:text-slate-400",ghost:"bg-transparent text-slate-200 hover:bg-slate-800/40 disabled:text-slate-500 disabled:hover:bg-transparent",danger:"bg-red-500 text-white hover:bg-red-400 disabled:bg-red-700/70 disabled:text-red-300",destructive:"bg-red-700 text-white hover:bg-red-600 disabled:bg-red-900/60 disabled:text-red-300",success:"bg-green-600 text-white hover:bg-green-500 disabled:bg-green-800/60 disabled:text-green-200",warning:"bg-orange-500 text-white hover:bg-orange-400 disabled:bg-orange-700/60 disabled:text-orange-200",outline:"border border-slate-600 text-slate-200 hover:bg-slate-800/30 disabled:opacity-50 disabled:hover:bg-transparent",link:"underline underline-offset-2 text-yellow-400 hover:text-yellow-300 p-0 bg-transparent disabled:text-yellow-600",soft:"bg-yellow-500/15 text-yellow-400 hover:bg-yellow-500/25 disabled:opacity-50 disabled:text-yellow-600"}[a],{sm:"h-8 px-3 text-xs",default:"h-10 px-4 text-sm",lg:"h-12 px-6 text-base"}[l],t),...n})}},27815:function(e,t,a){"use strict";a.d(t,{Zb:function(){return l}});var r=a(3827);a(64090);var s=a(1657);function l(e){let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,s.cn)("rounded-2xl border border-slate-800 bg-slate-900/80 backdrop-blur-sm","p-4 shadow-md shadow-black/40 transition","hover:shadow-lg hover:shadow-black/50",t),...a})}},45179:function(e,t,a){"use strict";a.d(t,{I:function(){return l}});var r=a(3827);a(64090);var s=a(1657);function l(e){let{className:t,error:a,...l}=e;return(0,r.jsx)("input",{className:(0,s.cn)("block w-full rounded-lg border bg-slate-900 px-3 py-2 text-sm text-slate-100 shadow-sm","placeholder:text-slate-500","focus:outline-none focus:ring-1",a?"border-red-500 focus:ring-red-500":"border-slate-700 focus:border-yellow-500 focus:ring-yellow-500","disabled:cursor-not-allowed disabled:opacity-60",t),"aria-invalid":a||void 0,...l})}},1657:function(e,t,a){"use strict";a.d(t,{cn:function(){return l}});var r=a(75504),s=a(51367);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}},57977:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var r=a(64090);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),n=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},i=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:n,className:c="",children:u,iconNode:x,...m}=e;return(0,r.createElement)("svg",{ref:t,...d,width:s,height:s,stroke:a,strokeWidth:n?24*Number(l)/Number(s):l,className:o("lucide",c),...!u&&!i(m)&&{"aria-hidden":"true"},...m},[...x.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let a=(0,r.forwardRef)((a,l)=>{let{className:i,...d}=a;return(0,r.createElement)(c,{ref:l,iconNode:t,className:o("lucide-".concat(s(n(e))),"lucide-".concat(e),i),...d})});return a.displayName=n(e),a}},10527:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(57977).Z)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},8792:function(e,t,a){"use strict";a.d(t,{default:function(){return s.a}});var r=a(25250),s=a.n(r)},47907:function(e,t,a){"use strict";var r=a(15313);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})}},function(e){e.O(0,[150,434,971,69,744],function(){return e(e.s=68573)}),_N_E=e.O()}]);