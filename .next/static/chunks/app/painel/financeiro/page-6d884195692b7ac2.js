(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[890],{575:function(e,t,a){Promise.resolve().then(a.bind(a,47985))},47985:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var s=a(3827),r=a(64090),n=a(27815),l=a(85754),o=a(31478),i=a(21446),c=a(10527);let d=(0,a(57977).Z)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var u=a(19175),x=a(79990);function m(e){let{numero:t,mensagem:a}=e,[n,o]=(0,r.useState)(!1),[i,c]=(0,r.useState)(!1);async function d(){o(!0),c(!1);try{(await fetch("/api/whatsapp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({numero:t,mensagem:a})})).ok&&c(!0)}catch(e){console.error("Erro ao enviar WhatsApp:",e)}o(!1),setTimeout(()=>c(!1),2500)}return(0,s.jsx)(l.z,{variant:"outline",size:"sm",onClick:d,disabled:n,className:"flex items-center gap-2",children:n?"Enviando...":i?"Enviado!":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.Z,{className:"w-4 h-4"})," WhatsApp"]})})}function p(){let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)(!0),[x,p]=(0,r.useState)(""),[v,f]=(0,r.useState)(""),[g,y]=(0,r.useState)(""),[j,w]=(0,r.useState)(""),[N,C]=(0,r.useState)(null);async function k(){i(!0);let e=await fetch("/api/pagamentos");t(await e.json()),i(!1)}function A(e){return e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}function D(e){return e?new Date(e).toLocaleDateString("pt-BR"):"—"}(0,r.useEffect)(()=>{k()},[]);let S=(0,r.useMemo)(()=>e.filter(e=>{var t,a;let s=x.trim().toLowerCase(),r=!s||e.descricao.toLowerCase().includes(s)||((null===(t=e.aluno)||void 0===t?void 0:t.nome)||"").toLowerCase().includes(s)||((null===(a=e.responsavel)||void 0===a?void 0:a.nome)||"").toLowerCase().includes(s),n=!v||e.status.toUpperCase()===v.toUpperCase(),l=new Date(e.vencimento),o=!g||l>=new Date(g+"T00:00:00"),i=!j||l<=new Date(j+"T23:59:59");return r&&n&&o&&i}),[e,x,v,g,j]),P=(0,r.useMemo)(()=>{let e=0,t=0,a=0,s=0;return S.forEach(r=>{var n;let l=null!==(n=r.valor)&&void 0!==n?n:0;e+=l;let o=r.status.toUpperCase();"PAGO"===o?t+=l:"ATRASADO"===o?s+=l:a+=l}),{total:e,pago:t,pendente:a,atrasado:s}},[S]);async function z(e){confirm("Deseja marcar esta cobran\xe7a como PAGA?")&&(await fetch("/api/pagamentos/".concat(e),{method:"PUT",body:JSON.stringify({status:"PAGO"})}),await k())}return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-xl md:text-2xl font-bold text-slate-100 flex items-center gap-2",children:[(0,s.jsx)(c.Z,{className:"h-5 w-5 text-yellow-400"}),"Financeiro geral"]}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:"Acompanhe todas as cobran\xe7as: status, valores, vencimentos e situa\xe7\xe3o por aluno/respons\xe1vel."})]}),(0,s.jsx)(l.z,{variant:"primary",onClick:k,disabled:a,className:"flex items-center gap-2",children:"Atualizar dados"})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,s.jsx)(h,{titulo:"Total lan\xe7ado",valor:P.total}),(0,s.jsx)(h,{titulo:"Recebido",valor:P.pago}),(0,s.jsx)(h,{titulo:"Pendente",valor:P.pendente}),(0,s.jsx)(h,{titulo:"Em atraso",valor:P.atrasado})]}),(0,s.jsx)(n.Zb,{className:"p-4 bg-slate-900 border border-slate-700 space-y-4",children:"..."}),(0,s.jsx)(n.Zb,{className:"p-0 bg-slate-900 border border-slate-700 overflow-hidden",children:a?(0,s.jsx)("p",{className:"p-4 text-sm text-slate-400",children:"Carregando cobran\xe7as..."}):0===S.length?(0,s.jsx)("p",{className:"p-4 text-sm text-slate-400",children:"Nenhuma cobran\xe7a encontrada."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:"..."}),(0,s.jsx)("tbody",{children:S.map(e=>{var t,a,r,n,i,c,x;return(0,s.jsxs)("tr",{className:"border-t border-slate-800 hover:bg-slate-800/50",children:[(0,s.jsx)("td",{className:"px-4 py-3 text-slate-100",children:e.descricao}),(0,s.jsx)("td",{className:"px-4 py-3 text-slate-300",children:null!==(i=null===(t=e.aluno)||void 0===t?void 0:t.nome)&&void 0!==i?i:"—"}),(0,s.jsx)("td",{className:"px-4 py-3 text-slate-300",children:null!==(c=null===(a=e.responsavel)||void 0===a?void 0:a.nome)&&void 0!==c?c:"—"}),(0,s.jsx)("td",{className:"px-4 py-3 text-slate-400",children:D(e.vencimento)}),(0,s.jsx)("td",{className:"px-4 py-3 text-slate-100",children:A(e.valor)}),(0,s.jsx)("td",{className:"px-4 py-3",children:function(e){let t=null==e?void 0:e.toUpperCase();return"PAGO"===t?(0,s.jsx)(o.C,{variant:"success",children:"Pago"}):"ATRASADO"===t?(0,s.jsx)(o.C,{variant:"danger",children:"Atrasado"}):"PENDENTE"===t?(0,s.jsx)(o.C,{variant:"warning",children:"Pendente"}):(0,s.jsx)(o.C,{variant:"outline",children:e})}(e.status)}),(0,s.jsx)("td",{className:"px-4 py-3 text-right",children:(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsxs)(l.z,{size:"sm",variant:"secondary",onClick:()=>C(e),children:[(0,s.jsx)(d,{className:"h-3 w-3"})," Ver"]}),"PAGO"!==e.status.toUpperCase()&&(0,s.jsxs)(l.z,{size:"sm",variant:"primary",onClick:()=>z(e.id),children:[(0,s.jsx)(u.Z,{className:"h-3 w-3"})," Pago"]}),(0,s.jsx)(m,{numero:(null===(r=e.responsavel)||void 0===r?void 0:r.telefone)||"",mensagem:"Ol\xe1 ".concat(null===(n=e.responsavel)||void 0===n?void 0:n.nome,",\n\nLembrete da cobran\xe7a:\n").concat(e.descricao,"\nValor: R$ ").concat(A(e.valor),"\nVencimento: ").concat(D(e.vencimento),"\n\nPIX:\n").concat(null!==(x=e.pixPayload)&&void 0!==x?x:"Acesse o portal para ver.")})]})})]},e.id)})})]})})}),N&&(0,s.jsx)(b,{pagamento:N,onClose:()=>C(null)})]})}function h(e){let{titulo:t,valor:a}=e;return(0,s.jsx)(n.Zb,{className:"p-4 bg-slate-900 border border-slate-700 flex flex-col justify-between",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 uppercase tracking-wide",children:t}),(0,s.jsx)("p",{className:"mt-2 text-lg font-bold text-slate-100",children:a.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]}),(0,s.jsx)(c.Z,{className:"h-5 w-5 text-yellow-400"})]})})}function b(e){var t,a,r,o,c,d,u;let{pagamento:x,onClose:m}=e;function p(e){return e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}function h(e){return new Date(e).toLocaleDateString("pt-BR")}return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,s.jsxs)(n.Zb,{className:"w-full max-w-md p-6 bg-slate-900 border border-slate-700 space-y-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-100",children:"Detalhes da cobran\xe7a"}),(0,s.jsxs)("p",{className:"text-sm text-slate-300",children:[(0,s.jsx)("strong",{children:"Descri\xe7\xe3o:"})," ",x.descricao]}),(0,s.jsxs)("p",{className:"text-sm text-slate-300",children:[(0,s.jsx)("strong",{children:"Aluno:"})," ",null!==(d=null===(t=x.aluno)||void 0===t?void 0:t.nome)&&void 0!==d?d:"—"]}),(0,s.jsxs)("p",{className:"text-sm text-slate-300",children:[(0,s.jsx)("strong",{children:"Respons\xe1vel:"})," ",null!==(u=null===(a=x.responsavel)||void 0===a?void 0:a.nome)&&void 0!==u?u:"—"]}),(0,s.jsxs)("p",{className:"text-sm text-slate-300",children:[(0,s.jsx)("strong",{children:"Vencimento:"})," ",h(x.vencimento)]}),(0,s.jsxs)("p",{className:"text-sm text-slate-300",children:[(0,s.jsx)("strong",{children:"Valor:"})," ",p(x.valor)]}),(0,s.jsxs)("p",{className:"text-sm text-slate-300",children:[(0,s.jsx)("strong",{children:"Status:"})," ",x.status]}),x.boletoUrl&&(0,s.jsx)("a",{href:x.boletoUrl,target:"_blank",rel:"noreferrer",className:"text-xs text-yellow-400 underline",children:"Abrir boleto banc\xe1rio"}),x.pixQrCode&&(0,s.jsx)("img",{src:x.pixQrCode,alt:"QR Code PIX",className:"w-40 mx-auto"}),(0,s.jsxs)("div",{className:"flex flex-col gap-3 mt-4",children:[x.pixPayload&&(0,s.jsx)(l.z,{variant:"secondary",onClick:()=>navigator.clipboard.writeText(x.pixPayload),children:"Copiar c\xf3digo PIX"}),(0,s.jsx)(i.T,{numero:(null===(r=x.responsavel)||void 0===r?void 0:r.telefone)||"",nomeResponsavel:(null===(o=x.responsavel)||void 0===o?void 0:o.nome)||"Respons\xe1vel",nomeAluno:(null===(c=x.aluno)||void 0===c?void 0:c.nome)||"",descricao:x.descricao,valor:p(x.valor),vencimento:h(x.vencimento),pixPayload:x.pixPayload})]}),(0,s.jsx)("div",{className:"flex justify-end pt-2",children:(0,s.jsx)(l.z,{variant:"secondary",onClick:m,children:"Fechar"})})]})})}},21446:function(e,t,a){"use strict";a.d(t,{T:function(){return o}});var s=a(3827),r=a(64090),n=a(85754),l=a(79990);function o(e){let{numero:t,nomeResponsavel:a,nomeAluno:o,descricao:i,valor:c,vencimento:d,pixPayload:u}=e,[x,m]=(0,r.useState)(!1),[p,h]=(0,r.useState)(!1);async function b(){if(!t){alert("Respons\xe1vel n\xe3o possui telefone cadastrado.");return}m(!0),h(!1);let e="\nOl\xe1 ".concat(a,"!\n\nSegue novamente os dados da cobran\xe7a:\n\n\uD83D\uDCCC ").concat(i,"\n\uD83D\uDC66 Aluno: ").concat(null!=o?o:"—","\n\uD83D\uDCB0 Valor: ").concat(c,"\n\uD83D\uDCC5 Vencimento: ").concat(d,"\n\n\uD83D\uDD17 C\xf3digo PIX:\n").concat(null!=u?u:"Acesse o portal para visualizar.","\n\nQualquer d\xfavida estamos \xe0 disposi\xe7\xe3o!\n  ").trim();try{(await fetch("/api/whatsapp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({numero:t,mensagem:e})})).ok&&h(!0)}catch(e){console.error(e)}m(!1),setTimeout(()=>h(!1),2e3)}return(0,s.jsx)(n.z,{size:"sm",variant:"primary",onClick:b,disabled:x,className:"flex items-center gap-1",children:x?"Enviando...":p?"Enviado!":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Z,{className:"h-3 w-3"})," Reenviar PIX"]})})}},31478:function(e,t,a){"use strict";a.d(t,{C:function(){return n}});var s=a(3827);a(64090);var r=a(1657);function n(e){let{className:t,variant:a="default",...n}=e;return(0,s.jsx)("span",{className:(0,r.cn)("inline-flex items-center rounded-full px-2.5 py-0.5","text-[11px] font-medium uppercase tracking-wide",{default:"bg-slate-800 text-slate-100 border border-slate-700",outline:"bg-transparent text-slate-200 border border-slate-500",success:"bg-emerald-600/20 text-emerald-300 border border-emerald-500/50",warning:"bg-amber-500/15 text-amber-300 border border-amber-400/70",danger:"bg-red-500/15 text-red-300 border border-red-400/70"}[a],t),role:"status",...n})}},85754:function(e,t,a){"use strict";a.d(t,{z:function(){return n}});var s=a(3827);a(64090);var r=a(1657);function n(e){let{className:t,variant:a="primary",size:n="default",...l}=e;return(0,s.jsx)("button",{className:(0,r.cn)("inline-flex items-center justify-center gap-2 rounded-lg font-medium transition-all select-none","focus:outline-none focus:ring-2 focus:ring-yellow-500/70 focus:ring-offset-2 focus:ring-offset-slate-950","disabled:cursor-not-allowed disabled:opacity-70",{primary:"bg-yellow-500 text-slate-900 hover:bg-yellow-400 disabled:bg-yellow-700/60 disabled:text-slate-400",secondary:"bg-slate-700 text-slate-100 hover:bg-slate-600 disabled:bg-slate-800/70 disabled:text-slate-400",ghost:"bg-transparent text-slate-200 hover:bg-slate-800/40 disabled:text-slate-500 disabled:hover:bg-transparent",danger:"bg-red-500 text-white hover:bg-red-400 disabled:bg-red-700/70 disabled:text-red-300",destructive:"bg-red-700 text-white hover:bg-red-600 disabled:bg-red-900/60 disabled:text-red-300",success:"bg-green-600 text-white hover:bg-green-500 disabled:bg-green-800/60 disabled:text-green-200",warning:"bg-orange-500 text-white hover:bg-orange-400 disabled:bg-orange-700/60 disabled:text-orange-200",outline:"border border-slate-600 text-slate-200 hover:bg-slate-800/30 disabled:opacity-50 disabled:hover:bg-transparent",link:"underline underline-offset-2 text-yellow-400 hover:text-yellow-300 p-0 bg-transparent disabled:text-yellow-600",soft:"bg-yellow-500/15 text-yellow-400 hover:bg-yellow-500/25 disabled:opacity-50 disabled:text-yellow-600"}[a],{sm:"h-8 px-3 text-xs",default:"h-10 px-4 text-sm",lg:"h-12 px-6 text-base"}[n],t),...l})}},27815:function(e,t,a){"use strict";a.d(t,{Zb:function(){return n}});var s=a(3827);a(64090);var r=a(1657);function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("rounded-2xl border border-slate-800 bg-slate-900/80 backdrop-blur-sm","p-4 shadow-md shadow-black/40 transition","hover:shadow-lg hover:shadow-black/50",t),...a})}},1657:function(e,t,a){"use strict";a.d(t,{cn:function(){return n}});var s=a(75504),r=a(51367);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}},57977:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var s=a(64090);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),l=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},i=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,s.forwardRef)((e,t)=>{let{color:a="currentColor",size:r=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:d="",children:u,iconNode:x,...m}=e;return(0,s.createElement)("svg",{ref:t,...c,width:r,height:r,stroke:a,strokeWidth:l?24*Number(n)/Number(r):n,className:o("lucide",d),...!u&&!i(m)&&{"aria-hidden":"true"},...m},[...x.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let a=(0,s.forwardRef)((a,n)=>{let{className:i,...c}=a;return(0,s.createElement)(d,{ref:n,iconNode:t,className:o("lucide-".concat(r(l(e))),"lucide-".concat(e),i),...c})});return a.displayName=l(e),a}},19175:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(57977).Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},10527:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(57977).Z)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},79990:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(57977).Z)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])}},function(e){e.O(0,[150,971,69,744],function(){return e(e.s=575)}),_N_E=e.O()}]);