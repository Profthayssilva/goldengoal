(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[25],{59455:function(e,t,a){Promise.resolve().then(a.bind(a,25485))},25485:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var s=a(3827),l=a(64090),r=a(40059),n=a(27815),i=a(85754),o=a(45179);function d(e){let{onClose:t,onSaved:a}=e,[r,d]=(0,l.useState)({name:"",email:"",password:"",role:"gestor"}),[c,u]=(0,l.useState)(!1);function x(e,t){d(a=>({...a,[e]:t}))}async function h(){if(!r.email||!r.password){alert("Informe e-mail e senha.");return}u(!0);let e=await fetch("/api/users",{method:"POST",body:JSON.stringify(r)});if(u(!1),!e.ok){alert("Erro ao criar usu\xe1rio.");return}a(),t()}return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,s.jsxs)(n.Zb,{className:"w-full max-w-md p-6 bg-slate-900 border border-slate-700 space-y-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-100",children:"Novo usu\xe1rio"}),(0,s.jsx)(o.I,{placeholder:"Nome",value:r.name,onChange:e=>x("name",e.target.value)}),(0,s.jsx)(o.I,{type:"email",placeholder:"E-mail",value:r.email,onChange:e=>x("email",e.target.value)}),(0,s.jsx)(o.I,{type:"password",placeholder:"Senha",value:r.password,onChange:e=>x("password",e.target.value)}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-slate-400 mb-1 block",children:"Perfil"}),(0,s.jsxs)("select",{className:"w-full bg-slate-900 border border-slate-700 rounded-lg p-2 text-slate-100",value:r.role,onChange:e=>x("role",e.target.value),children:[(0,s.jsx)("option",{value:"admin",children:"Admin"}),(0,s.jsx)("option",{value:"gestor",children:"Gestor"})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,s.jsx)(i.z,{variant:"secondary",onClick:t,children:"Cancelar"}),(0,s.jsx)(i.z,{variant:"primary",disabled:c,onClick:h,children:c?"Salvando...":"Salvar"})]})]})})}function c(e){var t,a,r;let{user:d,onClose:c,onSaved:u}=e,[x,h]=(0,l.useState)({name:null!==(t=d.name)&&void 0!==t?t:"",email:null!==(a=d.email)&&void 0!==a?a:"",role:null!==(r=d.role)&&void 0!==r?r:"gestor",newPassword:""}),[m,b]=(0,l.useState)(!1);function f(e,t){h(a=>({...a,[e]:t}))}async function p(){b(!0);let e={name:x.name,email:x.email,role:x.role};x.newPassword&&(e.password=x.newPassword);let t=await fetch("/api/users/".concat(d.id),{method:"PUT",body:JSON.stringify(e)});if(b(!1),!t.ok){alert("Erro ao atualizar usu\xe1rio.");return}u(),c()}return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,s.jsxs)(n.Zb,{className:"w-full max-w-md p-6 bg-slate-900 border border-slate-700 space-y-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-100",children:"Editar usu\xe1rio"}),(0,s.jsx)(o.I,{placeholder:"Nome",value:x.name,onChange:e=>f("name",e.target.value)}),(0,s.jsx)(o.I,{type:"email",placeholder:"E-mail",value:x.email,onChange:e=>f("email",e.target.value)}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-slate-400 mb-1 block",children:"Perfil"}),(0,s.jsxs)("select",{className:"w-full bg-slate-900 border border-slate-700 rounded-lg p-2 text-slate-100",value:x.role,onChange:e=>f("role",e.target.value),children:[(0,s.jsx)("option",{value:"admin",children:"Admin"}),(0,s.jsx)("option",{value:"gestor",children:"Gestor"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-slate-400 mb-1 block",children:"Nova senha (opcional)"}),(0,s.jsx)(o.I,{type:"password",placeholder:"Deixe em branco para n\xe3o alterar",value:x.newPassword,onChange:e=>f("newPassword",e.target.value)})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,s.jsx)(i.z,{variant:"secondary",onClick:c,children:"Cancelar"}),(0,s.jsx)(i.z,{variant:"primary",disabled:m,onClick:p,children:m?"Salvando...":"Salvar altera\xe7\xf5es"})]})]})})}function u(e){let{id:t,onClose:a,onDeleted:l}=e;async function r(){if(!(await fetch("/api/users/".concat(t),{method:"DELETE"})).ok){alert("Erro ao excluir usu\xe1rio.");return}l(),a()}return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-6 z-50",children:(0,s.jsxs)(n.Zb,{className:"w-full max-w-sm p-6 bg-slate-900 border border-slate-700 space-y-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-100",children:"Confirmar exclus\xe3o"}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:"Tem certeza que deseja excluir este usu\xe1rio?"}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-3",children:[(0,s.jsx)(i.z,{variant:"secondary",onClick:a,children:"Cancelar"}),(0,s.jsx)(i.z,{variant:"destructive",onClick:r,children:"Excluir"})]})]})})}function x(){let[e,t]=(0,l.useState)([]),[a,o]=(0,l.useState)(!0),[x,h]=(0,l.useState)(!1),[m,b]=(0,l.useState)(null),[f,p]=(0,l.useState)(null);async function g(){o(!0);let e=await fetch("/api/users");t(await e.json()),o(!1)}return(0,l.useEffect)(()=>{g()},[]),(0,s.jsx)(r.Z,{allowed:["admin"],children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-slate-100",children:"Usu\xe1rios"}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:"Gest\xe3o de contas de acesso ao painel."})]}),(0,s.jsx)(i.z,{variant:"primary",onClick:()=>h(!0),children:"Novo usu\xe1rio"})]}),(0,s.jsx)(n.Zb,{className:"p-4 bg-slate-900 border border-slate-700",children:a?(0,s.jsx)("p",{className:"text-sm text-slate-400",children:"Carregando..."}):0===e.length?(0,s.jsx)("p",{className:"text-sm text-slate-500",children:"Nenhum usu\xe1rio cadastrado."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-slate-700 text-slate-400",children:[(0,s.jsx)("th",{className:"py-2",children:"Nome"}),(0,s.jsx)("th",{className:"py-2",children:"Email"}),(0,s.jsx)("th",{className:"py-2",children:"Perfil"}),(0,s.jsx)("th",{className:"py-2",children:"Criado em"}),(0,s.jsx)("th",{className:"py-2 text-right",children:"A\xe7\xf5es"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>{var t,a,l;return(0,s.jsxs)("tr",{className:"border-b border-slate-800 last:border-0",children:[(0,s.jsx)("td",{className:"py-2 text-slate-100",children:null!==(t=e.name)&&void 0!==t?t:"—"}),(0,s.jsx)("td",{className:"py-2 text-slate-300",children:null!==(a=e.email)&&void 0!==a?a:"—"}),(0,s.jsx)("td",{className:"py-2 text-slate-300 capitalize",children:null!==(l=e.role)&&void 0!==l?l:"—"}),(0,s.jsx)("td",{className:"py-2 text-slate-400",children:new Date(e.createdAt).toLocaleDateString("pt-BR")}),(0,s.jsxs)("td",{className:"py-2 text-right space-x-2",children:[(0,s.jsx)(i.z,{variant:"secondary",size:"sm",onClick:()=>b(e),children:"Editar"}),(0,s.jsx)(i.z,{variant:"destructive",size:"sm",onClick:()=>p(e.id),children:"Excluir"})]})]},e.id)})})]})})}),x&&(0,s.jsx)(d,{onClose:()=>h(!1),onSaved:g}),m&&(0,s.jsx)(c,{user:m,onClose:()=>b(null),onSaved:g}),f&&(0,s.jsx)(u,{id:f,onClose:()=>p(null),onDeleted:g})]})})}},40059:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(3827),l=a(64090),r=a(47907);function n(e){let{allowed:t,children:a}=e,n=(0,r.useRouter)(),[i,o]=(0,l.useState)(null),[d,c]=(0,l.useState)(!0);if((0,l.useEffect)(()=>{(async function(){try{let e=await fetch("/api/auth/me",{cache:"no-store"}),t=await e.json();if(!t.logado){n.replace("/login");return}o(t.role)}catch(e){n.replace("/login")}finally{c(!1)}})()},[n]),d)return null;let u=t.map(e=>e.toUpperCase());return i&&u.includes(i.toUpperCase())?(0,s.jsx)(s.Fragment,{children:a}):(n.replace("/painel/dashboard"),null)}},85754:function(e,t,a){"use strict";a.d(t,{z:function(){return r}});var s=a(3827);a(64090);var l=a(1657);function r(e){let{className:t,variant:a="primary",size:r="default",...n}=e;return(0,s.jsx)("button",{className:(0,l.cn)("inline-flex items-center justify-center gap-2 rounded-lg font-medium transition-all select-none","focus:outline-none focus:ring-2 focus:ring-yellow-500/70 focus:ring-offset-2 focus:ring-offset-slate-950","disabled:cursor-not-allowed disabled:opacity-70",{primary:"bg-yellow-500 text-slate-900 hover:bg-yellow-400 disabled:bg-yellow-700/60 disabled:text-slate-400",secondary:"bg-slate-700 text-slate-100 hover:bg-slate-600 disabled:bg-slate-800/70 disabled:text-slate-400",ghost:"bg-transparent text-slate-200 hover:bg-slate-800/40 disabled:text-slate-500 disabled:hover:bg-transparent",danger:"bg-red-500 text-white hover:bg-red-400 disabled:bg-red-700/70 disabled:text-red-300",destructive:"bg-red-700 text-white hover:bg-red-600 disabled:bg-red-900/60 disabled:text-red-300",success:"bg-green-600 text-white hover:bg-green-500 disabled:bg-green-800/60 disabled:text-green-200",warning:"bg-orange-500 text-white hover:bg-orange-400 disabled:bg-orange-700/60 disabled:text-orange-200",outline:"border border-slate-600 text-slate-200 hover:bg-slate-800/30 disabled:opacity-50 disabled:hover:bg-transparent",link:"underline underline-offset-2 text-yellow-400 hover:text-yellow-300 p-0 bg-transparent disabled:text-yellow-600",soft:"bg-yellow-500/15 text-yellow-400 hover:bg-yellow-500/25 disabled:opacity-50 disabled:text-yellow-600"}[a],{sm:"h-8 px-3 text-xs",default:"h-10 px-4 text-sm",lg:"h-12 px-6 text-base"}[r],t),...n})}},27815:function(e,t,a){"use strict";a.d(t,{Zb:function(){return r}});var s=a(3827);a(64090);var l=a(1657);function r(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("rounded-2xl border border-slate-800 bg-slate-900/80 backdrop-blur-sm","p-4 shadow-md shadow-black/40 transition","hover:shadow-lg hover:shadow-black/50",t),...a})}},45179:function(e,t,a){"use strict";a.d(t,{I:function(){return r}});var s=a(3827);a(64090);var l=a(1657);function r(e){let{className:t,error:a,...r}=e;return(0,s.jsx)("input",{className:(0,l.cn)("block w-full rounded-lg border bg-slate-900 px-3 py-2 text-sm text-slate-100 shadow-sm","placeholder:text-slate-500","focus:outline-none focus:ring-1",a?"border-red-500 focus:ring-red-500":"border-slate-700 focus:border-yellow-500 focus:ring-yellow-500","disabled:cursor-not-allowed disabled:opacity-60",t),"aria-invalid":a||void 0,...r})}},1657:function(e,t,a){"use strict";a.d(t,{cn:function(){return r}});var s=a(75504),l=a(51367);function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,l.m6)((0,s.W)(t))}},47907:function(e,t,a){"use strict";var s=a(15313);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[150,971,69,744],function(){return e(e.s=59455)}),_N_E=e.O()}]);