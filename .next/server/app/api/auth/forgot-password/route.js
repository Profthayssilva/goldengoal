"use strict";(()=>{var e={};e.id=9118,e.ids=[9118],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},9523:e=>{e.exports=require("dns")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},6005:e=>{e.exports=require("node:crypto")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},66647:(e,r,o)=>{o.r(r),o.d(r,{headerHooks:()=>w,originalPathname:()=>g,patchFetch:()=>_,requestAsyncStorage:()=>v,routeModule:()=>h,serverHooks:()=>S,staticGenerationAsyncStorage:()=>x,staticGenerationBailout:()=>P});var t={};o.r(t),o.d(t,{POST:()=>f});var a=o(95419),n=o(69108),s=o(99678),i=o(78070),u=o(9108),p=o(70207),l=o(6113),c=o.n(l),d=o(5988);async function m(e,r){let o=`${process.env.APP_URL}/reset/${r}`,t=`
    <p>Voc\xea solicitou a redefini\xe7\xe3o de senha.</p>
    <p>Clique no link abaixo para continuar:</p>
    <p><a href="${o}">${o}</a></p>
    <p>Se voc\xea n\xe3o solicitou, ignore este e-mail.</p>
  `;await (0,d.Yb)({to:e,subject:"Redefini\xe7\xe3o de senha",html:t})}async function f(e){try{let r=await e.json(),o=p.ek.safeParse(r);if(!o.success)return i.default.json({error:"E-mail inv\xe1lido."},{status:400});let{email:t}=o.data;if(!await u.Z.user.findUnique({where:{email:t}}))return i.default.json({ok:!0});let a=c().randomBytes(32).toString("hex");return await u.Z.verificationToken.create({data:{identifier:t,token:a,expires:new Date(Date.now()+36e5)}}),await m(t,a),i.default.json({ok:!0})}catch(e){return console.error("Forgot-password error:",e),i.default.json({error:"Erro interno."},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/forgot-password/route",pathname:"/api/auth/forgot-password",filename:"route",bundlePath:"app/api/auth/forgot-password/route"},resolvedPagePath:"D:\\fut7\\app\\api\\auth\\forgot-password\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:v,staticGenerationAsyncStorage:x,serverHooks:S,headerHooks:w,staticGenerationBailout:P}=h,g="/api/auth/forgot-password/route";function _(){return(0,s.patchFetch)({serverHooks:S,staticGenerationAsyncStorage:x})}},5988:(e,r,o)=>{o.d(r,{Yb:()=>f,_S:()=>i});var t=o(75180),a=o(68140);let n=process.env.RESEND_API_KEY,s=n?new t.R(n):null;async function i(e,r){let o=`
    <p>Ol\xe1!</p>
    <p>Clique no link abaixo para redefinir sua senha:</p>
    <a href="${r}" target="_blank">${r}</a>
    <p>Este link expira em 30 minutos.</p>
  `;if(s)try{await s.emails.send({from:"no-reply@goldengoal.com",to:e,subject:"Recupera\xe7\xe3o de senha",html:o});return}catch(e){console.error("[mail] ERRO ao enviar via Resend, tentando SMTP:",e)}await f({to:e,subject:"Recupera\xe7\xe3o de senha",html:o})}let u=process.env.SMTP_HOST,p=Number(process.env.SMTP_PORT||587),l=process.env.SMTP_USER,c=process.env.SMTP_PASS,d=process.env.SMTP_FROM||"no-reply@goldengoal.com",m=null;async function f(e){if(!m){console.warn("[mail] Tentativa de enviar email SEM SMTP configurado:",e);return}try{await m.sendMail({from:d,to:e.to,subject:e.subject,html:e.html})}catch(e){console.error("[mail] Erro ao enviar via SMTP:",e)}}u&&l&&c?m=a.createTransport({host:u,port:p,secure:465===p,auth:{user:l,pass:c}}):console.warn("[mail] SMTP N\xc3O configurado. Configure SMTP_HOST, SMTP_USER, SMTP_PASS no .env")},9108:(e,r,o)=>{o.d(r,{Z:()=>a});let t=require("@prisma/client"),a=globalThis.prisma??new t.PrismaClient({log:["query","error","warn"]})},70207:(e,r,o)=>{o.d(r,{S4:()=>n,ek:()=>a});var t=o(18801);t.Ryn({name:t.Z_8().min(2,"Nome obrigat\xf3rio"),email:t.Z_8().email("Email inv\xe1lido"),password:t.Z_8().min(6,"Senha deve ter pelo menos 6 caracteres"),role:t.KmV(["admin","gestor","responsavel"]).optional().default("responsavel")}),t.Ryn({name:t.Z_8().min(2).optional(),email:t.Z_8().email().optional(),role:t.KmV(["admin","gestor","responsavel"]).optional()});let a=t.Ryn({email:t.Z_8().email()}),n=t.Ryn({token:t.Z_8().min(10),password:t.Z_8().min(6)});t.Ryn({currentPassword:t.Z_8().min(6),newPassword:t.Z_8().min(6)})}};var r=require("../../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[1638,6206,8801,527],()=>o(66647));module.exports=t})();