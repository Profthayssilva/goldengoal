"use strict";(()=>{var e={};e.id=5057,e.ids=[5057],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},38766:(e,a,t)=>{t.r(a),t.d(a,{headerHooks:()=>A,originalPathname:()=>f,patchFetch:()=>g,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>v,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>S});var r={};t.r(r),t.d(r,{POST:()=>d});var o=t(95419),n=t(69108),s=t(99678),i=t(9108),p=t(84113),u=t(78070);async function d(e){try{let a=await e.json(),t=await i.prisma.responsavel.findUnique({where:{id:a.responsavelId}});if(!t?.asaasCustomerId)return u.default.json({error:"Respons\xe1vel n\xe3o possui cliente ASAAS"},{status:400});let r=await (0,p.bZ)("/payments",{method:"POST",body:JSON.stringify({customer:t.asaasCustomerId,billingType:a.tipo??"PIX",value:a.valor,dueDate:a.vencimento,description:a.descricao})}),o=await i.prisma.pagamento.create({data:{descricao:a.descricao,valor:a.valor,vencimento:new Date(a.vencimento),status:"pendente",alunoId:a.alunoId,responsavelId:a.responsavelId,asaasPaymentId:r.id,pixQrCode:r.pixQrCode??null,pixPayload:r.pixCopyPaste??null,boletoUrl:r.bankSlipUrl??null}});return u.default.json(o)}catch(e){return console.error(e),u.default.json({error:"Erro ao criar pagamento"},{status:400})}}let c=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/pagamentos/create/route",pathname:"/api/pagamentos/create",filename:"route",bundlePath:"app/api/pagamentos/create/route"},resolvedPagePath:"D:\\fut7\\app\\api\\pagamentos\\create\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:v,headerHooks:A,staticGenerationBailout:S}=c,f="/api/pagamentos/create/route";function g(){return(0,s.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:m})}},84113:(e,a,t)=>{t.d(a,{Jn:()=>s,Z8:()=>i,bZ:()=>n});let r=process.env.ASAAS_BASE_URL||"https://sandbox.asaas.com/api/v3",o=process.env.ASAAS_API_KEY;async function n(e,a={}){let t={"Content-Type":"application/json",access_token:o,...a.headers||{}},n=await fetch(`${r}${e}`,{...a,headers:t});if(!n.ok){let e=await n.text();throw console.error("[ASAAS] Erro:",n.status,e),Error("Erro ao comunicar com ASAAS")}return n.json()}async function s(e){let a={name:e.name,email:e.email??void 0,cpfCnpj:e.cpfCnpj??void 0,mobilePhone:e.phone??void 0};return e.address&&(a.address=e.address),await n("/customers",{method:"POST",body:JSON.stringify(a)})}async function i(e){let a={customer:e.customerId,billingType:"PIX",value:e.value,dueDate:e.dueDate,description:e.description};return await n("/payments",{method:"POST",body:JSON.stringify(a)})}o||console.warn("[ASAAS] ⚠️ ASAAS_API_KEY n\xe3o configurada. Integra\xe7\xe3o ficar\xe1 inativa.")},9108:(e,a,t)=>{t.d(a,{Z:()=>o});let r=require("@prisma/client"),o=globalThis.prisma??new r.PrismaClient({log:["query","error","warn"]})}};var a=require("../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[1638,6206],()=>t(38766));module.exports=r})();