"use strict";(()=>{var a={};a.id=3940,a.ids=[3940],a.modules={30517:a=>{a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32650:(a,e,r)=>{r.r(e),r.d(e,{headerHooks:()=>g,originalPathname:()=>P,patchFetch:()=>y,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>h});var t={};r.r(t),r.d(t,{POST:()=>u});var o=r(95419),s=r(69108),n=r(99678),i=r(78070),p=r(9108);async function u(a){try{let{descricao:e,valor:r,vencimento:t,alunoId:o,responsavelId:s,customerId:n}=await a.json(),u=await fetch("https://api.asaas.com/v3/payments",{method:"POST",headers:{"Content-Type":"application/json",access_token:process.env.ASAAS_API_KEY},body:JSON.stringify({customer:n,value:r,description:e,dueDate:t,billingType:"PIX"})}),l=await u.json();if(l.errors)return console.error("Erro Asaas:",l),i.default.json({error:"Erro ao criar cobran\xe7a Asaas"},{status:400});let c=await p.prisma.pagamento.create({data:{descricao:e,valor:r,vencimento:new Date(t),status:"PENDENTE",alunoId:o,responsavelId:s,asaasPaymentId:l.id,boletoUrl:l?.bankSlipUrl??null,pixQrCode:l?.pixQrCode??null,pixPayload:l?.pixPayload??null}});return i.default.json(c)}catch(a){return console.error(a),i.default.json({error:"Erro interno ao criar cobran\xe7a"},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/pagamentos/asaas-create/route",pathname:"/api/pagamentos/asaas-create",filename:"route",bundlePath:"app/api/pagamentos/asaas-create/route"},resolvedPagePath:"D:\\fut7\\app\\api\\pagamentos\\asaas-create\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:m,headerHooks:g,staticGenerationBailout:h}=l,P="/api/pagamentos/asaas-create/route";function y(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},9108:(a,e,r)=>{r.d(e,{Z:()=>o});let t=require("@prisma/client"),o=globalThis.prisma??new t.PrismaClient({log:["query","error","warn"]})}};var e=require("../../../../webpack-runtime.js");e.C(a);var r=a=>e(e.s=a),t=e.X(0,[1638,6206],()=>r(32650));module.exports=t})();